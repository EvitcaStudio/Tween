/**
* Class for creating a tweening animation
* @class Tween  
* @license
* Tween does not have a license at this time.
* For licensing contact the author
* @author https://github.com/doubleactii
* Copyright (c) 2023 Evitca Studio
*/ export class Tween{constructor({start:t={},end:e={},duration:s=1e3,easing:i=Tween.linear}={}){this._build(t,e,s,i)}static linear(t,e,s,i){return s*t/i+e}static easeInQuad(t,e,s,i){return s*(t/=i)*t+e}static easeOutQuad(t,e,s,i){return-s*(t/=i)*(t-2)+e}static easeInOutQuad(t,e,s,i){return(t/=i/2)<1?s/2*t*t+e:-s/2*(--t*(t-2)-1)+e}static easeInSine(t,e,s,i){return-s*Math.cos(t/i*(Math.PI/2))+s+e}static easeOutSine(t,e,s,i){return s*Math.sin(t/i*(Math.PI/2))+e}static easeInOutSine(t,e,s,i){return-s/2*(Math.cos(Math.PI*t/i)-1)+e}static easeInExpo(t,e,s,i){return 0==t?e:s*Math.pow(2,10*(t/i-1))+e}static easeOutExpo(t,e,s,i){return t==i?e+s:s*(-Math.pow(2,-10*t/i)+1)+e}static easeInOutExpo(t,e,s,i){return 0==t?e:t==i?e+s:(t/=i/2)<1?s/2*Math.pow(2,10*(t-1))+e:s/2*(-Math.pow(2,-10*--t)+2)+e}static easeInCirc(t,e,s,i){return-s*(Math.sqrt(1-(t/=i)*t)-1)+e}static easeOutCirc(t,e,s,i){return s*Math.sqrt(1-(t=t/i-1)*t)+e}static easeInOutCirc(t,e,s,i){return(t/=i/2)<1?-s/2*(Math.sqrt(1-t*t)-1)+e:s/2*(Math.sqrt(1-(t-=2)*t)+1)+e}static easeInCubic(t,e,s,i){return s*(t/=i)*t*t+e}static easeOutCubic(t,e,s,i){return s*((t=t/i-1)*t*t+1)+e}static easeInOutCubic(t,e,s,i){return(t/=i/2)<1?s/2*t*t*t+e:s/2*((t-=2)*t*t+2)+e}static easeInQuart(t,e,s,i){return s*(t/=i)*t*t*t+e}static easeOutQuart(t,e,s,i){return-s*((t=t/i-1)*t*t*t-1)+e}static easeInOutQuart(t,e,s,i){return(t/=i/2)<1?s/2*t*t*t*t+e:-s/2*((t-=2)*t*t*t-2)+e}static easeInQuint(t,e,s,i){return s*(t/=i)*t*t*t*t+e}static easeOutQuint(t,e,s,i){return s*((t=t/i-1)*t*t*t*t+1)+e}static easeInOutQuint(t,e,s,i){return(t/=i/2)<1?s/2*t*t*t*t*t+e:s/2*((t-=2)*t*t*t*t+2)+e}static easeInElastic(t,e,s,i){var a=1.70158,n=0,r=s;if(0==t)return e;if(1==(t/=i))return e+s;if(n||(n=.3*i),r<Math.abs(s)){r=s;var a=n/4}else if(0===s&&0===r)a=n/(2*Math.PI)*Math.asin(1);else var a=n/(2*Math.PI)*Math.asin(s/r);return-(r*Math.pow(2,10*(t-=1))*Math.sin((t*i-a)*(2*Math.PI)/n))+e}static easeOutElastic(t,e,s,i){var a=1.70158,n=0,r=s;if(0==t)return e;if(1==(t/=i))return e+s;if(n||(n=.3*i),r<Math.abs(s)){r=s;var a=n/4}else if(0===s&&0===r)a=n/(2*Math.PI)*Math.asin(1);else var a=n/(2*Math.PI)*Math.asin(s/r);return r*Math.pow(2,-10*t)*Math.sin((t*i-a)*(2*Math.PI)/n)+s+e}static easeInOutElastic(t,e,s,i){var a=1.70158,n=0,r=s;if(0==t)return e;if(2==(t/=i/2))return e+s;if(n||(n=i*(.3*1.5)),r<Math.abs(s)){r=s;var a=n/4}else if(0===s&&0===r)a=n/(2*Math.PI)*Math.asin(1);else var a=n/(2*Math.PI)*Math.asin(s/r);return t<1?-.5*(r*Math.pow(2,10*(t-=1))*Math.sin((t*i-a)*(2*Math.PI)/n))+e:r*Math.pow(2,-10*(t-=1))*Math.sin((t*i-a)*(2*Math.PI)/n)*.5+s+e}static easeInBack(t,e,s,i){return s*(t/=i)*t*(2.70158*t-1.70158)+e}static easeOutBack(t,e,s,i){return s*((t=t/i-1)*t*(2.70158*t+1.70158)+1)+e}static easeInOutBack(t,e,s,i){var a=1.70158;return(t/=i/2)<1?s/2*(t*t*(((a*=1.525)+1)*t-a))+e:s/2*((t-=2)*t*(((a*=1.525)+1)*t+a)+2)+e}static easeInBounce(t,e,s,i){return s-this.easeOutBounce(i-t,0,s,i)+e}static easeOutBounce(t,e,s,i){return(t/=i)<1/2.75?7.5625*s*t*t+e:t<2/2.75?s*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?s*(7.5625*(t-=2.25/2.75)*t+.9375)+e:s*(7.5625*(t-=2.625/2.75)*t+.984375)+e}static easeInOutBounce(t,e,s,i){return t<.5*i?.5*this.easeInBounce(2*t,0,s,i)+e:.5*this.easeOutBounce(2*t-i,0,s,i)+.5*s+e}static _clamp(t,e=0,s=1){return Math.max(e,Math.min(t,s))}static _hexToRgb(t){3===(t=t.replace("#","")).length&&(t=t.replace(RegExp("(.)","g"),"$1$1")),t=t.match(RegExp("..","g"));let e=Tween._clamp(parseInt(t[0],16),0,255),s=Tween._clamp(parseInt(t[1],16),0,255),i=Tween._clamp(parseInt(t[2],16),0,255);return[e,s,i]}static _rgbToHex(t){if(Array.isArray(t))return"#"+t.map(t=>Math.abs(Math.round(t)).toString(16).padStart(2,"0")).join("")}_build(t,e,s,i){this.start=t,this.end=e,this.duration=s,this.easing="function"==typeof i?i:Tween.linear,this.events={},this.tweening=!1,this.update=null,this.paused=!1,this.lastTime=0,this.elapsed=0}build({start:t={},end:e={},duration:s=1e3,easing:i=Tween.linear}={}){return this._build(t,e,s,i),this}on(t,e){if("function"==typeof e)switch(t){case"start":case"end":case"pause":case"resume":this.events[t]=e;break;default:console.error(`The event "${t}" is not supported.`)}else console.error(`The callback for event "${t}" is not a function.`);return this}animationFrame=()=>{if(!this.tweening||this.paused)return;let t=performance.now();this.lastTime||(this.lastTime=t),this.elapsed+=t-this.lastTime;let e=this.elapsed/this.duration;this.oscillating&&(e=(1-Math.cos(e*Math.PI))/2),e>1&&(e=1);let s={};for(let i in this.end){let a=this.start[i],n=this.end[i];if("string"==typeof a&&(3===a.length||6===a.length)||4===a.length||7===a.length){a=Tween._hexToRgb(a),n=Tween._hexToRgb(n);let r=[this.easing(e,a[0],n[0]-a[0],1),this.easing(e,a[1],n[1]-a[1],1),this.easing(e,a[2],n[2]-a[2],1)];s[i]=Tween._rgbToHex(r)}else s[i]=this.easing(e,a,n-a,1)}this.update(s),1!==e||this.oscillating?requestAnimationFrame(this.animationFrame):(this.stop(),this.events.end&&this.events.end()),this.lastTime=t};animate(t,e=!1){if("function"!=typeof t){console.error("The pUpdate parameter passed to animate is not a function.");return}if(this.tweening)return;let s=Object.keys(this.start),i=Object.keys(this.end);if(!s.length||!i.length){console.error("The start object or the end object has no properties.");return}if(!s.every(t=>i.includes(t))){console.error("The end object is missing properties that the start object has.");return}return this.update=t,this.tweening=!0,this.elapsed=0,this.oscillating=e,this.events.start&&this.events.start(),requestAnimationFrame(this.animationFrame),this}resume(){return this.paused&&(this.lastTime=performance.now(),this.paused=!1,this.events.resume&&this.events.resume(),requestAnimationFrame(this.animationFrame)),this}pause(){return!this.paused&&(this.paused=!0,this.events.pause&&this.events.pause()),this}stop(){this.tweening=!1,this.oscillating=!1,this.update=null,this.elapsed=0,this.lastTime=0,this.paused=!1}}